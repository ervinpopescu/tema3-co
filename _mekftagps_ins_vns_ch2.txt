                   Sensors 2018, 18, 3809                                                                                 3of22
                        To address the issues concerning the dynamic model errors and, in particular, measurement
                   outliers, we propose an adaptive robust approach for two-antenna GPS/INS LC integration in which
                   the IAE method is utilized to design a factor for the adaptive covariance. Several equations concerned
                   withIAEdrawbacksarederivedtoaccountforandovercomethenumericalandfeedbackissuesof
                   two-antennaGPS/INSintegrationcausedbymeasurementoutliersandunknownstateuncertainties,
                   and an adaptive reconï¬guration for measurement noise covariance according to measurement
                   reliability is designed. The desirable properties of the proposed approach are summarized as follows:
                   â€¢    Adaptive modification of noise covariance can treat dynamic model errors and measurement
                        disturbancetoreducetheirimpactonstateestimation,especiallywhenthestatisticsofbothmeasured
                        andpredictednoisehavetobeadapted. Withfilterupdating,positivefeedbackandnumericalissues
                        canbereducedbyquantifyingstatisticalmeasurementnoiseonamoregranularlevelbasedonthe
                        correspondingquantificationsofmeasurementreliabilityinthecaseofmeasurementoutliers.
                   â€¢    Theproposedmethodcanaccuratelyquantifymeasurementreliability. Itisanevidence-based
                        regulation method with the beneï¬t of attenuating the impact of innovation perturbation.
                        In addition to the assured stability of ï¬lter updating, the performance of the augmented
                        measurementequationinstateerrorfeedbackforpreciousmeasurementsisimproved.
                        Thepaperisorganizedasfollows. Anoverviewofthetwo-antennaGPS/INS-integratedalgorithmis
                   providedinSection2. InSection3,theadaptivemodificationofnoisecovarianceisdiscussed. Thefield
                   experiment and results for different schemes are compared in Section 4 to verify the superiority of the
                   proposedapproachcomparedtoexistingmethods. Finally,severalconclusionsofthisworkaredrawn.
                   2. Two-AntennaGPS/INS
                   2.1. Inertial Dynamic Model
                        The inertial dynamic model is derived from the Psi-Angle error model based on INS error
                   differential equations and summarized as [43]:
                                                   .
                                                 Î´r = âˆ’Ï‰ Ã—Î´r+Î´v
                                                   .       en
                                                                                             n b
                                                 Î´v = fÃ—Ïˆâˆ’(2Ï‰ +Ï‰ )Ã—Î´v+Î´g+C Î´f                                                (1)
                                                   .                ie     en                b
                                                  Ïˆ=âˆ’(Ï‰ +Ï‰ )Ã—Ïˆâˆ’CnÎ´Ï‰b
                                                            ie     en          b
                   whereÎ´denotesthecorrespondingerrororuncertaintyofthevectors, . denotestheï¬rstderivatives,
                                                                                               â€¢
                   Ã—denotesthecross-productoftwovectors, Î´r, Î´v, and Ïˆ are the position, velocity, and attitude error
                   state vectors, respectively, f is the speciï¬c force vector, Ï‰   is the earth rotation vector, and Ï‰    is the
                                                                                 ie                                    en
                   craft-rate vector [44]. Î´fb and Î´Ï‰b are the accelerometer error and gyroscope error, respectively, and are
                   written as:
                                                                b                b
                                                              Î´f =b +diag(f )s
                                                                      a             a                                        (2)
                                                             Î´Ï‰b = b +diag(Ï‰b)s
                                                                      g              g
                   wherediag(â€¢)denotesthediagonalformofthematrix,andb ands aretheaccelerometerbiasand
                                                                                      a      a
                   accelerometer scale factor vectors, respectively. bg and sg are the gyroscope bias and gyroscope scale
                   factor vectors, respectively. The inertial measurement unit (IMU) sensor error terms Îµ, such as bias and
                   scale factors, are modeled as ï¬rst-order Gaussâ€“Markov (GM) processes:
                                                                 .       âˆ’1
                                                                 Îµ = âˆ’T    Îµ+wÎµ                                              (3)
                   where T is the correlation time, wÎµ is the corresponding process noise vector, and Î´g is the gravity
                   uncertainty error vector, projected as:
                                                          Î´g = diagâˆ’Ï‰2âˆ’Ï‰2 2Ï‰2)Î´r                                            (4)
                                                                          s     s    s
                                                                                                                  
                                                                                       GLDJ                    
                                                                                                    V       V      V
                                       V
                          Sensors 2018, 18, 3809                                                                                                                     4of22
                          whereÏ‰ denotestheSchulerfrequency[43â€“47]. Subscriptbindicatesthebodyframe(b-frame)with
                                      s                                                              Q
                                                                                                     E
                          vehicle axes, i.e., forwardâ€“transversalâ€“down. Subscript n indicates the navigation frame (n-frame) is a
                          local geodetic frame with the x-axis towards geodetic north, the z-axis towards an orthogonal to the
                          reference ellipsoid pointing down, and the y-axis completing a right-handed orthogonal frame, i.e.,
                                                                 n
                          northâ€“eastâ€“down(NED).C isthedirectioncosinematrix(DCM)fromthebodyframetothen-frame.
                                                                 b
                                 In this research, an INS error with 21 states was developed according to the equations mentioned
                                                                                                                        7
                          above. Nine navigation parameters expressed in the n-frame, and 12 inertial sensor error parameters
                                                                                                 È¥             
                                                                                                         J   D   J   D
                          expressed in the b-frame, are involved. The complete error state sequence is expressed as:
                                                                                Î´x = (Î´r Î´v Ïˆ b b s s )T                                                                 (5)
                                                                                                       g a g a
                          2.2. Measurement Model
                                 Figure 1 illustrates the physical location relationship between the IMU and GNSS rover with two
                          antennas (Ant 1 and Ant 2) in the b-frame.
                                                                                           l
                                                                                             
                                                                  l                     l
                                                                                          
                                                                    
                                 Figure 1. Physical-location relationship between the inertial measurement unit (IMU) and two Global
                                 Navigation Satellite System (GNSS) receiver antennas in the body frame.
                                 Where li is the level arm vector between the IMU and i-th antenna, while l12 is the level arm
                          vector between the two antennas, and can be expressed as:
                                                                                                                                        
                                                                                           l   =l2âˆ’l                                                                     (6)
                                                                                            12             1
                                                                                                        
                                                                                                                   43]:
                                 Thelinearized position error measurement equation is [
                                                                                                    Q                Q
                                                                                                  n                  n
                                                                                                                        È¥
                                                               âˆ†Zr = r           âˆ’r         +C l =Î´r+(C l Ã—)Ïˆâˆ’e                                                          (7)
                                                                           IMU       GPS1            1                  1            e
                                                                                 ,08     *36      E                E               r
                                                                                                  b                  b
                                                                                                                                      1
                          whereâˆ†denotesthedifferencebetweenmeasurementsandpredictions. Thelinearizedvelocityerror
                          measurementequationis[43]:
                                                                     Q    E                  Q
                                                                   È¦  È¦                          
                                                         n     b                       n
                                                          ,08       E               LQ      E      *36
                              âˆ†Zv = (v            +(C (Ï‰ Ã—)âˆ’(Ï‰ Ã—))C l âˆ’v                                )
                                            IMU          b                   in        b 1       GPS1                                                                    (8)
                                                                         Q            Q          E             Q                Q                E
                                                               n                n            b                 n                  n                    b
                                                             È¦                          È¦  È¥                             GLDJÈ¦ 
                                      =Î´vâˆ’((Ï‰ Ã—)C (l Ã—)+C ((l Ã—Ï‰ )Ã—))Ïˆ+C (l Ã—)b +C (l Ã—)diag(Ï‰ )s âˆ’e
                                                                                                                                                           
                                                       in         LQ     E           E                       E         g    E                          g
                                                                    1                1                             1                  1                           e
                                                               b                b                              b                  b                              v1
                          whereâ€¢            andâ€¢          indicate that the corresponding vectors are obtained by the INS mechanization
                                        ,08               *36
                                      IMU           GPS
                          algorithm and GPS-RTK algorithm, respectively. (â€¢Ã—) denotes the skew symmetric matrix form of
                                                                                                                              
                          avector. e        ande arethecorrespondingmeasurementwhite-noisevectors. Ï‰ istherotationrate
                                         e          e                                                                                          in
                                         r1         v1
                          vector, and is expressed as:
                                                                                       Ï‰ =Ï‰ +Ï‰                                                                          (9)
                                                                                          in        ie       en
                 Sensors 2018, 18, 3809                                                                  5of22
                     AccordingtoEquation(7),anotherpositionerrormeasurementequationrelatedtoRover2can
                 beconstructed as follows:
                                                               n           n
                                        âˆ†Zr = r     âˆ’r     +C l =Î´r+(C l Ã—)Ïˆâˆ’e                             (10)
                                                IMU    GPS2     2            2       e
                                                               b           b         r2
                 wheree isthecorrespondingmeasurementwhitenoisevector.
                        e
                        r2
                     l12 has already been accurately calibrated in the b-frame and is considered as a constraint
                 that can be used for fast AR ï¬xing, even for a low-cost single-frequency receiver. Assume that
                                                  e
                 the two-antenna baseline vector p  in the earth frame (e-frame) can be accurately estimated by
                                                  12
                 moving-reference-receiver GPS-RTK processing that a method used to determine relative position
                 vector between the antennas mounted to a single platform. Then, the attitude error measurement
                 equation can be constructed using the difference between Equations (7) and (10):
                                                       n                     n
                                        âˆ†ZÏˆ =r     +C l âˆ’r       âˆ’(r     +C l âˆ’r       )
                                               IMU     b 1   GPS1    IMU     b 2   GPS2
                                                n       n e                                                (11)
                                             =C l âˆ’C p
                                                b 12    e 12
                                                 n
                                             =(C l Ã—)Ïˆâˆ’e
                                                   12        e
                                                 b           r12
                                                                                  n
                 wheree   is the differential measurement white-noise sequence, and C is the DCM from the e-frame
                        e
                        r12                                                       e
                 to the n-frame.
                     Consequently, the ninth-order measurement error model of the proposed two-antenna GPS/INS
                 integration is given by:
                                                         âˆ†Z=HÎ´x+e                                          (12)
                 whereâˆ†Zisthemeasurementvector,HisthemeasurementmatrixcalculatedbasedonEquations(7),
                 (8), and (11), e is the measurement white-noise sequence and, determined by GPS/RTKs, results in
                 error variance that reï¬‚ects measurement uncertainty.
                   âˆ†Z=âˆ†Zrâˆ†Zvâˆ†ZÏˆT
                     e = e  e  e  T
                           e  e  e
                         ï£®r1 v1 r12                                                                    ï£¹
                                                n                                                          (13)
                           I    0              C (l Ã—)                  0      0          0          0
                         ï£¯ 3                    b 1                                                    ï£º
                    H=                     n          n       b       n             n            b
                         ï£° 0 I     (Ï‰ Ã—)C (l Ã—)+C ((l Ã—Ï‰ )Ã—) C (l Ã—) 0 C l Ã—)diag(Ï‰ ) 0 ï£»
                                3     in   b 1        b  1            b 1           b 1
                                                n
                            0   0              C (l Ã—)                  0      0          0          0
                                                b 12
                 whereI isthethird-orderunitmatrix,0isthird-order zero matrix.
                        3
                 3. Adaptive Noise Covariance
                     Asnotedintheintroduction,KFshavebeenwidelyusedindatafusion,andtheirperformance
                 relies on the accuracy of the dynamic and measurement models, and the statistical accuracy of the
                 noise covariance (Q and R). Fortunately, Q and R can still be adjusted to reï¬‚ect the actual uncertainties
                 of state estimation in the long term.
                     Theinitial state error covariance matrix reï¬‚ects the initial state-ï¬ltering accuracy, with little effect
                 onthesubsequentï¬lterupdating. TheweightbetweenQandRdeterminestheKalmangain,which
                 directly determines the impact that Q and R have on the state estimation. Therefore, the focus of the
                 noise covariance reconstruction is partially shifted toward Q and R.
                 3.1. Adaptive Process Noise Covariance
                     Process noise covariance Q should be adjusted by the ï¬lter algorithm as it cannot be easily
                 controlled directly unless adaptive factor Î± is used to tune the predicted state covariance. Pâˆ’ can be
                 expressed as [26]:
                                                       âˆ’        Ë† T
                                                      P =Î±(Î¦PÎ¦ +Qt)                                        (14)
                  Sensors 2018, 18, 3809                                                                            6of22
                  where Î¦ denotes the state-transition matrix computed from the INS dynamic system, t is the
                                           Ë†                                                                âˆ’
                  discretization time, and P is the previous measurement updated state covariance. â€¢Ë† and â€¢   denotesthe
                  measurementupdatedparameterandpredictedparameter,respectively. Î± isascalarvalue,updated
                                                                                                                       Ë†
                  basedontheweightbetweenthecovariancematrixofthepredictedresidualvector,denotedasCÎ¾,
                                                                                                            Ë†
                  andthetheoretical covariance matrix of the predicted residual vector, denoted as CÎ¾. CÎ¾ and CÎ¾ are
                  expressed as [26]:
                                                                      âˆ’ T
                                                             CÎ¾ = HP H +R                                             (15)
                                                             Ë†      T
                                                             CÎ¾ = Î¾ Î¾
                  whereÎ¾ is the innovation sequence and expressed as [
                                                                          25]:
                                                               Î¾ = Zâˆ’HÎ´xâˆ’                                             (16)
                  withpredicted state sequence Î´xâˆ’.
                       BasedontheKalmanï¬lterprinciple,CÎ¾ reï¬‚ectspredictedmeasurementerrorandtheoretically
                             Ë†
                  equals to CÎ¾ in an ideal case (accurate dynamic model and measurement model, and their noise
                  statistics) [26]. Assume measurements are measured without outliers and their noise probability
                  density functions are accurate.
                                   Ë†
                       Let Î³ = tr(CÎ¾)/tr(CÎ¾), tr(â€¢) denotes the trace of a matrix. The adaptive function to determine
                  the adaptive factors is expressed as [25,26]:
                                                                ( 1.0, Î³ â‰¤ c
                                                            Î± =               0                                       (17)
                                                                    1 Î³, c â‰¤ Î³
                                                                   c0    0
                  where c0 is the corresponding empirical constant, which is typically equal to 1.5â€“2.0 according to
                  Reference [25].
                       Undertheconditionofaccuratemeasurementsoraccuratenoisestatistics,theKFtimeupdating
                  tends to be unstable when Î± > 1.0. Pâˆ’ is perturbed due to the dynamic model errors and should be
                  tunedlarger using Î± to ensure that Pâˆ’ closely reï¬‚ects the actual situation.
                  3.2. Adaptive Measurement Noise Covariance
                       Adaptivemodiï¬cationofthenoisecovarianceisatradeoffbetweentheconvergencerateandï¬lter
                  stability. The ï¬lter error propagation reï¬‚ects the accuracy of the state estimations to some degree. In an
                  idealKFapplication,tuningthenoisemodelstoyieldconsistentestimationerrorsanduncertaintiescan
                  also produce stable state estimates that track their true counterparts [46]. Î± makes Pâˆ’ larger, and thus
                  causes the ï¬lter gain value to increase, which increases the contribution of themeasurement outliers.
                  Measurementoutlier Î´Î¾ can be considered as the unknown or unidentiï¬ed uncertainty contained in
                  the innovation:
                                                                 e
                                                                 Î¾ = Î¾ +Î´Î¾                                            (18)
                       AccordingtoEquation(17),predictedstateerrorpropagationPâˆ’ canbeincreased Î²timeswithout
                  Î´Î¾, or inaccurately increased by Î± times with Î´Î¾ and
                                                            (Î¾+Î´Î¾)T(Î¾+Î´Î¾)  Î¾TÎ¾
                                                       Î² =     tr(C )   /tr(C )
                                                                   Î¾         Î¾                                        (19)
                                                        =1+(2Î´Î¾TÎ¾+Î´Î¾TÎ´Î¾)/Î¾TÎ¾
                       In the measurement updating procedure, Kalman gain K is calculated by [47,48]:
                                                              âˆ’ T      âˆ’ T        âˆ’1
                                                        K=P H (HP H +R)                                               (20)
                   Sensors 2018, 18, 3809                                                                               7of22
                        ThemeasurementupdatingofthestateestimateÎ´xË† isformulatedasfollows:
                                                              âˆ’     e      âˆ’
                                                      Î´xË† = Î´x  +KÎ¾=Î´x +K(Î¾+Î´Î¾)                                          (21)
                        Alarge proportion of the perturbations in the measurement is fed back to the state estimates
                   because the corresponding gain value can be close to 1.0, subject to the large error magnitude of Pâˆ’.
                        If extreme measurement outliers occur, Î´Î¾ tends to be extremely large. Then,
                                                                  Î´Î¾TÎ´Î¾
                                                            |      âˆ’ T         â†’âˆ                                        (22)
                                                             tr HP H +R)
                        Compared to the uncorrected R, Î¾ contains large-magnitude errors. Therefore, Î± tends to be
                                                                                                                            e
                   extremely large. For a more intuitive analysis of the disadvantage of large measurement errors in Î¾,
                   weassumethatÎ±canbeconsideredtotendtoinï¬nity. BasedonLâ€™HÃ´pitalâ€™srule[49],thecorresponding
                   Kalmangaincanbederivedas:
                                               lim K = limK
                                              Î´vâ†’Îµ      Î±â†’âˆ
                                                               âˆ’ T        âˆ’ T       âˆ’1
                                                     = limÎ±P H (HÎ±P H +R)
                                                        Î±â†’âˆ                                                              (23)
                                                              âˆ’ T               âˆ’ T            âˆ’1
                                                     =[âˆ‚(Î±P H )/âˆ‚Î±][âˆ‚(HÎ±P H +R)/âˆ‚Î±]
                                                          âˆ’ T      âˆ’ T âˆ’1
                                                     =P H (HP H )
                                                                           âˆ’ T
                        AccordingtoEquation(13),everyblockoftheHP H matrixconsistsofthelineartransformation
                   of skew-symmetric matrices, the determination of which equals to 0. Therefore, ï¬lter crashes can
                   be produced due to singular-matrix inversion in the portion of the Kalman gain. This case rarely
                   exists in general because the determination of R doesnâ€™t equals to 0 and numerical issues cannot be
                   causedwhenprocessingmatrixinversioninEquation(23). However,whenthemeasurementoutlier
                   magnitudeismuchlargerthanthemagnitudeofR,thecontributionofRingaincalculationcanbe
                   degraded, even ignored, and positive feedback, ï¬lter divergence, even the numerical problem still
                   exist. Small errors in Pâˆ’ are relatively harmless; however, Equation (13) demonstrates that large
                   Pâˆ’-matrixerrors distort the Kalman gain matrix. R is often tuned by assigning state uncertainties that
                   are substantially larger to an extent that nearly equivalent to Î¾Î¾T, and the modiï¬ed measurement noise
                   covariance that contains unknown uncertainties R can be expressed as:
                                                             R=(Ï‚+Ï)(Ï‚+Ï)T                                               (24)
                   wheresequenceÏ‚indicatestheinaccuratestatisticaluncertainty,andisempiricallysmallerthantheactual
                   measurementuncertainties. ThesequenceÏrepresentstheunknownmeasurementuncertainties,which
                   are assumedtoapproximatelycorrespondwiththeactualoutliers. Thus,theadaptivefactoris:
                                                      Î³     1       Î¾TÎ¾ +2Î´Î¾TÎ¾+Î´Î¾TÎ´Î¾
                                                Î± = c = c tr(HPâˆ’HT)+Ï‚TÏ‚+2Ï‚TÏ+ÏTÏ                                         (25)
                                                      0     0
                        If the hypothesis of Equation (22) is established, Lâ€™HÃ´pitalâ€™s rule can be used to determine Î±, and it
                   turns out that:
                                          Î³     1       âˆ‚(Î¾TÎ¾ +2Î´Î¾TÎ¾+Î´Î¾TÎ´Î¾)                1 ||Î¾||2+|Î´Î¾||
                                     Î± =     =                                          =                 2              (26)
                                          c     c          âˆ’ T       T      T      T       c ||Ï‚|| +||Ï||
                                           0     0 âˆ‚(tr(HP H )+Ï‚ Ï‚+2Ï‚ Ï+Ï Ï)                0     2       2
                   where||â€¢||2 indicates two norms of a vector.
                        Duetotheintroductionof Ï, the contribution of measurement outliers is almost reduced with
                   respect to Î± and Pâˆ’ afterwards. Pâˆ’ reï¬‚ects the relatively precise uncertainty of the predicted
                   state estimates and cannot be extremely large. Therefore, Lâ€™HÃ´pitalâ€™s rule cannot be used in the
                    Sensors 2018, 18, 3809                                                                                      8of22
                                                                                                                    âˆ’ T        âˆ’1
                    implementationofEquation(23),numericalissuesconcerningtheinversionof (Î±HP H +R)                               are
                    resolved, and the impact of positive feedback is attenuated because of the consideration of unknown
                    measurementuncertainties in the Kalman gain determination. However, Ï is hard to be separated out;
                    the most popular robust method in IAE is to tune Î± further by using an adaptive robust function that
                    is expressed as [26]:                     ï£±
                                                              ï£´         1.0      ,  Î³â‰¤c0
                                                         Î± = ï£² Î³ Ã—(c1âˆ’c0),        c â‰¤Î³â‰¤c                                          (27)
                                                                  c      c âˆ’Î³       0          1
                                                              ï£´ 0       c1
                                                              ï£³          1      ,   c â‰¤Î³
                                                                         Î³           1
                    wherec isthecorrespondingempiricalconstant,whichistypicallyequalto4.5â€“8.5[50].
                             1
                          Unfortunately, some drawbacks still exist for the following reasons:
                    â€¢     When tuning a Kalman ï¬lter, unknown uncertainties cannot be easily separated from the
                          measurementnoise. Although ï¬lter stability is ensured by assigning substantially larger state
                          uncertainties, subjective assumption is introduced.
                    â€¢     The performance of measurement error equations in INS calibration is weakened when the
                          measurementisinthesteadystateandcannotcontinuallyprovidehigh-accuracypositioningand
                         velocity results. Due to dynamic model errors and self-drawbacks of INS mechanization, INS
                          cannot provide accurate state prediction. Due to low-accuracy a priori solutions or GPS outages,
                          Î³maybealsoextremelylargeevenwithoutameasurementoutlierbecauseEquation(27)cannot
                          ï¬gure out the source of larger innovation deviation. Therefore, Î± can be less than 1.0, and the
                          impactofPâˆ’ matrixerrorisincreased. AccordingtoEquations(21)and(23),asmallPâˆ’ matrix
                          error produces unresponsive state estimates, while Pâˆ’ of a too-large error magnitude produces
                          unstable, oscillatory state estimates [51].
                          The contributions of Pâˆ’ and R determine the impact of dynamic and measurement models
                    onthestate estimation, respectively. Following Equations (17) and (27), the adaptive modiï¬cation
                    of Pâˆ’ relies on R, which demonstrates that focus should be placed on the measurement outlier
                    detection and feedback. Hence, Figure 2 illustrates the proposed algorithm used to determine the
                    Ï in Equation (24). In the two-antenna GPS/INS-integrated navigation application, the original
                    Ris modiï¬ed based on ï¬lter measurement-updated covariance-solution processing by GPS-RTK,
                    and reï¬‚ects the ï¬lter accuracy of the GPS-RTK solution in detail (Î´er                 âˆˆ â„œ3Ã—1, Î´ve        âˆˆ â„œ3Ã—1,
                                                                                                     GPS               GPS
                    andÎ´pe      âˆˆâ„œ3Ã—1). Ï âˆˆ â„œ3Ã—1 is designed based on the position dilution of precision (PDOP) value,
                            GPS
                    numberofvaluable satellites (Nsat), AR ratio and length bias (dl) of pe             which can be obtained by
                                                                                                     12
                    GPS-RTKprocessing. These parameters can objectively reï¬‚ect the quality of RTK solutions, which
                    also improves for the modiï¬cation of measurement noise covariance matrix and the determination of
                    adaptive factors. To tune the measurement noise covariance matrix such that it closely aligns with the
                    actual error magnitudes, the modiï¬ed R is given by:
                                                                                 T
                                                                       R=E[ee ]                                                   (28)
                                                 e = diag[(Î´er     +Ï)(Î´ve        +Ï )(Î´pe       +Ï )]T
                                                               GPS     r     GPS      v      GPS     pe
                    whereÏr = [Ïr Ïr Ïr]T, Ïv = [Ïv Ïv Ïv]T and Ïpe = Ïpe Ïpe ÏpeT.
                          Theboundeddl(< âˆ†)isgivenby:
                                                                  dl =||pe  ||2âˆ’||l   ||                                          (29)
                                                                          12       12 2
                          Figure 2 shows the algorithm to adaptively modify the measurement noise covariance matrix.
                    Thefactors(Îº,Âµ,Î³,Î·)presentedintheï¬gurecanquantifyGPS-RTKreliabilityindetailtoappropriately
                    tune the measurement noise covariance matrix.
                                                                              7
                                                                          >     @
                                                                                                 7
                                                                                     
                                                       GLDJ>       È¡         È¡           @
                                                                                               
                                                               *36         *36          *36
                                                                                    7
                                          7                 7
                                                                     È¡  >        @
                            È¡  >       @   È¡  >       @
                                                                               
                                              
                                                                       
                                                                     __   __   __  __
                                                                               
                                                                      ç€Œæ¾³
                                       
                   Sensors 2018, 18, 3809                                                                                9of22
                                             PDOP                      Ratio                      Nsat
                                 ÎºPDOPâˆ’                   Î³âˆ’Ratio                Âµâˆ’ Nsat
                                                                                              Ïr Ïv
                                                                                                Ï
                                                                                                    
                                                                                                   p
                                      Î·_dl_
                                               <âˆ†
                                              _ dl _                                  â‰¤ÎºÂµÎ³Î· â‰¤ 
                                                                                                                    
                        Figure 2. A quantiï¬cation algorithm of Global Positioning System (GPS)-RTK reliability used in
                        Equation(28) based on PDOP, numberofvaluablesatellites, ratio, and length bias.
                        According to Figure 2, the adaptive measurement noise covariance matrix reconï¬guration
                   algorithm is formulated as the following equation. The algorithm is used to determine the driving
                   state or measurement reliability based on the quantiï¬cation results (Ïr, Ïv and Ïpe), which can be equal
                                                                                                             
                                                                                                             p
                   or close to 0 when the GPS-RTK solution is reliable. Otherwise, state uncertainties larger than 1Î´
                                                                                                                            
                   can occur in the instance when the measurement is less reliable. The factors mentioned in Figure 2,
                   like PDOP and ratio, are directly related to positioning performance [52â€“56]; hence, the proposed
                   measurementnoisecovariancematrixremodiï¬cationmethodismorefeasibleandï¬‚exiblecompared
                   withtheadaptiverobustmethodinEquation(27).
                                             Ï ,Ï = Îº(PDOPâˆ’3)+Î³(3âˆ’Ratio)+Âµ(6âˆ’Nsat)
                                              r   v                                                           (30)
                                                Ïep = Î·dl_   _
                                                      
                        In summary,theoverallï¬‚owchartofthetwo-antennaGPS/INSintegrationalgorithmisshown
                   in Figure 3. The IMU outputs are processed by the INS mechanization algorithm into navigation
                                                                                                                  n
                   parameters,includingposition,velocity,attitudevectors,andthederivedbaselinevectorC l12 between
                                                                                                                 b
                   thetwoantennas. TwoGPS-RTKprocessingschemeswereadoptedtoestimatethepositionandvelocity
                                                                                   n
                   vectors of Rover 1 and the two-antenna baseline vector p . In this research, the implementation
                                                                                   12
                   involves a ï¬lter based on the proposed approach.
